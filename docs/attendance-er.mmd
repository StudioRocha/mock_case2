erDiagram
    USERS {
        UNSIGNED_INTEGER id PK
        VARCHAR name
        VARCHAR email UK
        TIMESTAMP email_verified_at "nullable"
        VARCHAR password
        INTEGER role
        VARCHAR remember_token "nullable"
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    ATTENDANCES {
        UNSIGNED_INTEGER id PK
        UNSIGNED_INTEGER user_id FK
        DATE date
        DATETIME clock_in_time "nullable"
        DATETIME clock_out_time "nullable"
        INTEGER status
        VARCHAR note "500"
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    BREAK_TIMES {
        UNSIGNED_INTEGER id PK
        UNSIGNED_INTEGER attendance_id FK
        DATETIME break_start_time "nullable"
        DATETIME break_end_time "nullable"
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    STAMP_CORRECTION_REQUESTS {
        UNSIGNED_INTEGER id PK
        UNSIGNED_INTEGER attendance_id FK
        DATETIME requested_clock_in_time "nullable"
        DATETIME requested_clock_out_time "nullable"
        VARCHAR requested_note "500"
        INTEGER status
        TIMESTAMP approved_at "nullable"
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }
    BREAK_CORRECTIONS {
        UNSIGNED_INTEGER id PK
        UNSIGNED_INTEGER stamp_correction_request_id FK
        DATETIME requested_break_start_time "nullable"
        DATETIME requested_break_end_time "nullable"
        TIMESTAMP created_at
        TIMESTAMP updated_at
    }

    %% リレーション定義
    USERS ||--o{ ATTENDANCES : "USERS.id = ATTENDANCES.user_id"
    ATTENDANCES ||--o{ BREAK_TIMES : "ATTENDANCES.id = BREAK_TIMES.attendance_id"
    ATTENDANCES ||--o{ STAMP_CORRECTION_REQUESTS : "ATTENDANCES.id = STAMP_CORRECTION_REQUESTS.attendance_id"
    STAMP_CORRECTION_REQUESTS ||--o{ BREAK_CORRECTIONS : "STAMP_CORRECTION_REQUESTS.id = BREAK_CORRECTIONS.stamp_correction_request_id"
    
    %% 注意: STAMP_CORRECTION_REQUESTSの申請者はattendance.user_id経由で取得
    %% 承認者はapproved_atがNULLでないことで判定（承認者IDは保存しない）


